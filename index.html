<!DOCTYPE html>
<html>
<head>
  <title>Sight Words Master</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 50px; background: #f0f8ff; }
    h1 { color: #3366cc; }
    input { font-size: 30px; padding: 10px; }
    button { font-size: 30px; padding: 15px 30px; margin: 20px; background: #4CAF50; color: white; border: none; cursor: pointer; }
    #result { font-size: 40px; margin: 30px; }
    #listen { background: #ff9800; }
    #practiceToggle { background: #9C27B0; font-size: 20px; padding: 10px; }
    a { color: #3366cc; font-size: 20px; text-decoration: none; }
    #flashWord { font-size: 50px; color: #ff9800; margin: 20px; display: none; }
  </style>
</head>
<body>
  <h1>2nd & 3rd Grade Sight Words Practice</h1>
  <p>Listen to the sight word, then type it! Or toggle Practice Mode for flashcards.</p>
  <button id="practiceToggle" onclick="toggleMode()">üìö Practice Mode (Off)</button>
  <div id="flashWord"></div>
  <button id="listen" onclick="speak()">üîä Listen</button>
  <br>
  <input type="text" id="answer" placeholder="Type the word here">
  <br>
  <button onclick="check()">Check Answer</button>
  <button onclick="next()">Next Word</button>
  <div id="result"></div>
  <p>Score: <span id="score">0</span></p>

  <script>
    const words = [
      // Original 3rd Grade Dolch (41)
      "about","better","bring","carry","clean","cut","done","draw","drink","eight","fall","far","full","got","grow","hold","hot","hurt","if","keep","kind","laugh","light","long","much","myself","never","only","own","pick","seven","shall","show","six","small","start","ten","think","today","together","try","warm",
      // +46 Dolch 2nd Grade
      "always","around","because","been","before","best","both","buy","call","cold","does","dont","fast","first","five","found","gave","goes","green","its","made","many","off","or","pull","read","right","sing","sit","sleep","tell","their","these","those","upon","us","use","very","wash","which","why","wish","work","would","write","your",
      // +54 Fry 2nd/3rd Grade level (first 54 of Second 100)
      "after","again","air","also","america","animal","another","answer","any","around","ask","away","back","because","before","big","boy","came","change","different","does","end","even","follow","form","found","give","good","great","hand","help","here","home","house","just","kind","know","land","large","learn","letter","line","little","live","man","me","means","men","most","mother","move","much","must","name"
    ];
    let current = "";
    let score = 0;
    let practiceMode = false;

    function toggleMode() {
      practiceMode = !practiceMode;
      document.getElementById("practiceToggle").innerText = practiceMode ? "üéØ Quiz Mode (Audio Only)" : "üìö Practice Mode (Flashcards)";
      if (practiceMode) {
        next(); // Start with flash
      }
    }

    function next() {
      current = words[Math.floor(Math.random()*words.length)];
      document.getElementById("answer").value = "";
      document.getElementById("result").innerHTML = "";
      document.getElementById("flashWord").style.display = "none";
      if (practiceMode) {
        // Flash the word briefly for learning
        document.getElementById("flashWord").innerText = current;
        document.getElementById("flashWord").style.display = "block";
        speak();
        setTimeout(() => {
          document.getElementById("flashWord").style.display = "none";
        }, 2000); // Show for 2 seconds
      } else {
        speak(); // Auto-speak in quiz mode
      }
    }

    function speak() {
      if ('speechSynthesis' in window) {
        let voices = speechSynthesis.getVoices();
        let utterance = new SpeechSynthesisUtterance(current);
        
        // Strictly prioritize iPhone Siri voice: Samantha (or variants) for en-US
        let preferredVoice = voices.find(voice => 
          voice.lang.startsWith('en-US') && 
          (voice.name.toLowerCase().includes('samantha') || 
           (voice.name.toLowerCase().includes('siri') && voice.gender === 'female') ||
           (voice.name.toLowerCase().includes('alex') && voice.gender === 'male'))
        ) || voices.find(voice => 
          voice.name.toLowerCase().includes('natural') && voice.lang.startsWith('en-US')
        ) || voices.find(voice => 
          voice.lang.startsWith('en-US') && voice.gender === 'female'
        ) || voices[0];
        
        utterance.voice = preferredVoice;
        utterance.rate = 0.7; // Natural Siri-like pace: clear but not robotic
        utterance.pitch = 1.0; // Neutral, warm tone
        utterance.volume = 1;
        
        speechSynthesis.speak(utterance);
      } else {
        alert("Sorry, your device doesn't support voice. Try on a phone or computer.");
      }
    }

    function check() {
      let typed = document.getElementById("answer").value.trim().toLowerCase();
      let learnLink = `<br><a href="https://www.dictionary.com/browse/${current}" target="_blank">üìñ Learn more about ${current}</a>`;
      if (typed === current.toLowerCase()) {
        document.getElementById("result").innerHTML = "Correct! ‚≠ê" + learnLink;
        score++;
        speak(); // Reinforce by re-speaking on correct
      } else {
        document.getElementById("result").innerHTML = `Wrong. It's <b>${current}</b>.${learnLink} (listen again!)`;
        speak(); // Re-speak on wrong for practice
      }
      document.getElementById("score").innerText = score;
    }

    // Load voices (iOS Safari quirk: voices load async)
    speechSynthesis.onvoiceschanged = () => {
      if (speechSynthesis.getVoices().length > 0) {
        next();
      }
    };
    if (speechSynthesis.getVoices().length === 0) {
      setTimeout(next, 100); // Small delay for iOS
    } else {
      next(); // Fallback
    }
  </script>
</body>
</html>
